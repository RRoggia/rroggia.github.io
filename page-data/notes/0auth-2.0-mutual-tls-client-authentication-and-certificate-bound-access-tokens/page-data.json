{"componentChunkName":"component---src-templates-note-template-js","path":"/notes/0auth-2.0-mutual-tls-client-authentication-and-certificate-bound-access-tokens","result":{"data":{"markdownRemark":{"frontmatter":{"title":"0Auth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens","date":"2022-07-011","published":null,"tags":null},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#1-introduction\">1. Introduction</a></p>\n<ul>\n<li><a href=\"#12-terminology\">1.2 Terminology</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-mutual-tls-for-oauth-client-authentication\">2. Mutual TLS for OAuth Client Authentication</a></p>\n<ul>\n<li>\n<p><a href=\"#21-pki-mutual-tls-method\">2.1. PKI Mutual-TLS Method</a></p>\n<ul>\n<li><a href=\"#211-pki-method-metadata-value\">2.1.1 PKI Method Metadata Value</a></li>\n<li><a href=\"#212-client-registration-metadata\">2.1.2 Client Registration Metadata</a></li>\n</ul>\n</li>\n<li><a href=\"#22-self-signed-certificate-mutual-tls-method\">2.2. Self-Signed Certificate Mutual-TLS Method</a></li>\n</ul>\n</li>\n</ul>","html":"<h1>1. Introduction</h1>\n<blockquote>\n<p>This document describes an additional mechanism of client authentication utilizing mutual-TLS certificate-based authentication that provides better security characteristics than shared secrets.</p>\n</blockquote>\n<blockquote>\n<p>Mutual-TLS certificate-bound access tokens ensure that only the party in possession of the private key corresponding to the certificate can utilize the token to access the associated resources. </p>\n</blockquote>\n<blockquote>\n<p>Binding an access token to the client's certificate prevents the use of stolen access tokens or replay of access tokens by unauthorized parties.</p>\n</blockquote>\n<blockquote>\n<p>Mutual-TLS certificate-bound access tokens and mutual-TLS client authentication are distinct mechanisms that are complementary but don't necessarily need to be deployed or used together.</p>\n</blockquote>\n<h2>1.2 Terminology</h2>\n<blockquote>\n<p>Throughout this document the term \"mutual TLS\" refers to the process whereby, in addition to the normal TLS server authentication with a certificate, a client presents its X.509 certificate and proves possession of the corresponding private key to a server when negotiating a TLS session.</p>\n</blockquote>\n<h1>2. Mutual TLS for OAuth Client Authentication</h1>\n<blockquote>\n<p>For all requests to the authorization server utilizing mutual-TLS client authentication, the client include the client_id parameter</p>\n</blockquote>\n<blockquote>\n<p>In order to utilize TLS for OAuth client authentication, the TLS connection between the client and the authorization server have been established or re-established with mutual-TLS X.509 certificate authentication (i.e., the client Certificate and CertificateVerify messages are sent during the TLS handshake).</p>\n</blockquote>\n<blockquote>\n<p>The authorization server can locate the client configuration using the client identifier and check the certificate presented in the TLS handshake against the expected credentials for that client</p>\n</blockquote>\n<h2>2.1. PKI Mutual-TLS Method</h2>\n<blockquote>\n<p>It relies on a validated certificate chain and a single subject distinguished name (DN) or a single subject alternative name (SAN) to authenticate the client. Only one subject name value of any type is used for each client</p>\n</blockquote>\n<blockquote>\n<p>The TLS handshake is utilized to validate the client's possession of the private key corresponding to the public key in the certificate and to validate the corresponding certificate chain. The client is successfully authenticated if the subject information in the certificate matches the single expected subject configured or registered for that particular client</p>\n</blockquote>\n<h3>2.1.1 PKI Method Metadata Value</h3>\n<p>Adds the <code>tls_client_auth</code> HTTP Parameter.</p>\n<h3>2.1.2 Client Registration Metadata</h3>\n<blockquote>\n<p>A client using the tls<em>client</em>auth authentication method use exactly one of the below metadata parameters to indicate the certificate subject value that the authorization server is to expect when authenticating the respective client.</p>\n</blockquote>\n<p>During client registration:</p>\n<p><code>tls_client_auth_subject_dn</code> :  Subject distinguished name of the certificate</p>\n<p><code>tls_client_auth_san_dns</code>: dNSName SAN entry in the certificate</p>\n<p><code>tls_client_auth_san_uri</code>: uniformResourceIdentifier SAN entry in the certificate</p>\n<p><code>tls_client_auth_san_ip</code>: IP addres, either IPv4 or IPv6 y in the certificate</p>\n<p><code>tls_client_auth_san_email</code>: rfc822Name SAN entry in the certificate</p>\n<h2>2.2. Self-Signed Certificate Mutual-TLS Method</h2>"}},"pageContext":{"title":"0Auth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"}},"staticQueryHashes":["1507822185","2095566405","2894216461","425755332"]}