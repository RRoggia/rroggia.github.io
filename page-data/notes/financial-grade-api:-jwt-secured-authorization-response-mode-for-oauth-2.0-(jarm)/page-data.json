{"componentChunkName":"component---src-templates-note-template-js","path":"/notes/financial-grade-api:-jwt-secured-authorization-response-mode-for-oauth-2.0-(jarm)","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Financial-grade API: JWT Secured Authorization Response Mode for OAuth 2.0 (JARM)","date":"2022-07-08","published":null,"tags":null},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#introduction\">Introduction</a></p>\n<ul>\n<li>\n<p><a href=\"#41-the-jwt-response-document\">4.1. The JWT Response Document</a></p>\n<ul>\n<li><a href=\"#411-response-type-code\">4.1.1. Response Type Code</a></li>\n</ul>\n</li>\n<li><a href=\"#42-signing-and-encryption\">4.2. Signing and Encryption</a></li>\n<li>\n<p><a href=\"#43-response-encoding\">4.3. Response Encoding</a></p>\n<ul>\n<li><a href=\"#431-response-mode-queryjwt\">4.3.1. Response Mode \"query.jwt\"</a></li>\n<li><a href=\"#432-response-mode-fragmentjwt\">4.3.2. Response Mode \"fragment.jwt\"</a></li>\n<li><a href=\"#433-response-mode-form_postjwt\">4.3.3. Response Mode \"form_post.jwt\"</a></li>\n<li><a href=\"#434-response-mode-jwt\">4.3.4. Response Mode \"jwt\"</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","html":"<h1>Introduction</h1>\n<blockquote>\n<p>This document defines a new JWT-based mode to encode authorization responses. Clients are enabled to request the transmission of the authorization response parameters along with additional data in JWT format. This mechanism enhances the security of the standard authorization response since it adds support for signing and encryption, sender authentication, audience restriction as well as protection from replay, credential leakage, and mix-up attacks. It can be combined with any response type.</p>\n</blockquote>\n<h2>4.1. The JWT Response Document</h2>\n<blockquote>\n<p>The JWT always contains the following data utilized to secure the transmission:</p>\n<ul>\n<li>iss - the issuer URL of the authorization server that created the response</li>\n<li>aud - the client_id of the client the response is intended for</li>\n<li>exp - expiration of the JWT</li>\n</ul>\n</blockquote>\n<h3>4.1.1. Response Type Code</h3>\n<p>Example of authorization code grant flow sending the <code>code</code> and <code>state</code> within the JWT:</p>\n<pre><code>{\n\"iss\":\"https://accounts.example.com\",\n\"aud\":\"s6BhdRkqt3\",\n\"exp\":1311281970,\n\"code\":\"PyyFaux2o7Q0YfXBU32jhw.5FXSQpvr8akv9CeRDSd0QA\",\n\"state\":\"S8NJ7uqk5fY4EjNvP_G_FtyJu6pUsvH9jsYni9dMAJw\"\n}\n</code></pre>\n<p>Example of the <code>token</code>  response:</p>\n<pre><code>{\n\"iss\":\"https://accounts.example.com\",\n\"aud\":\"s6BhdRkqt3\",\n\"exp\":1311281970,\n\"access_token\":\"2YotnFZFEjr1zCsicMWpAA\",\n\"state\":\"S8NJ7uqk5fY4EjNvP_G_FtyJu6pUsvH9jsYni9dMAJw\",\n\"token_type\":\"bearer\",\n\"expires_in\":\"3600\",\n\"scope\":\"example\"\n}\n</code></pre>\n<h2>4.2. Signing and Encryption</h2>\n<blockquote>\n<p>The JWT is either signed, or signed and encrypted. If the JWT is both signed and encrypted, the JSON document will be signed then encrypted, with the result being a Nested JWT, as defined in [RFC7519].</p>\n</blockquote>\n<h2>4.3. Response Encoding</h2>\n<blockquote>\n<p>This draft defines the following response mode values:</p>\n<ul>\n<li>query.jwt</li>\n<li>fragment.jwt</li>\n<li>form_post.jwt</li>\n<li>jwt</li>\n</ul>\n</blockquote>\n<h3>4.3.1. Response Mode \"query.jwt\"</h3>\n<p>Redirects to client redirect URI adding a parameter <code>response</code> containing the JWT. The Content Type is <code>application/x-www-form-urlencoded</code>.</p>\n<pre><code>HTTP/1.1 302 Found\nLocation: https://client.example.com/cb?\nresponse=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2FjY291bnRzLm\nV4YW1wbGUuY29tIiwiYXVkIjoiczZCaGRSa3F0MyIsImV4cCI6MTMxMTI4MTk3MCwiY29kZSI6IlB5eU\nZhdXgybzdRMFlmWEJVMzJqaHcuNUZYU1FwdnI4YWt2OUNlUkRTZDBRQSIsInN0YXRlIjoiUzhOSjd1cW\ns1Zlk0RWpOdlBfR19GdHlKdTZwVXN2SDlqc1luaTlkTUFKdyJ9.HkdJ_TYgwBBj10C-aWuNUiA062Amq\n2b0_oyuc5P0aMTQphAqC2o9WbGSkpfuHVBowlb-zJ15tBvXDIABL_t83q6ajvjtq_pqsByiRK2dLVdUw\nKhW3P_9wjvI0K20gdoTNbNlP9Z41mhart4BqraIoI8e-L_EfAHfhCG_DDDv7Yg\n</code></pre>\n<blockquote>\n<p>Note: \"query.jwt\" MUST NOT be used in conjunction with response types that contain \"token\" or \"id_token\" unless the response JWT is encrypted to prevent token leakage in the URL.</p>\n</blockquote>\n<h3>4.3.2. Response Mode \"fragment.jwt\"</h3>\n<p>Same as query, but using fragment instead of a parameter.</p>\n<pre><code>HTTP/1.1 302 Found\nLocation: https://client.example.com/cb#\nresponse=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2FjY291bnRzLm\nV4YW1wbGUuY29tIiwiYXVkIjoiczZCaGRSa3F0MyIsImV4cCI6MTMxMTI4MTk3MCwiYWNjZXNzX3Rva2\nVuIjoiMllvdG5GWkZFanIxekNzaWNNV3BBQSIsInN0YXRlIjoiUzhOSjd1cWs1Zlk0RWpOdlBfR19GdH\nlKdTZwVXN2SDlqc1luaTlkTUFKdyIsInRva2VuX3R5cGUiOiJiZWFyZXIiLCJleHBpcmVzX2luIjoiMz\nYwMCIsInNjb3BlIjoiZXhhbXBsZSJ9.bgHLOu2dlDjtCnvTLK7hTN_JNwoZXEBnbXQx5vd9z17v1Hyzf\nMqz00Vi002T-SWf2JEs3IVSvAe1xWLIY0TeuaiegklJx_gvB59SQIhXX2ifzRmqPoDdmJGaWZ3tnRyFW\nNnEogJDqGFCo2RHtk8fXkE5IEiBD0g-tN0GS_XnxlE\n</code></pre>\n<h3>4.3.3. Response Mode \"form_post.jwt\"</h3>\n<blockquote>\n<p>The response parameter containing the JWT is encoded as HTML form value that is auto-submitted in the User Agent, and thus is transmitted via the HTTP POST method to the Client, with the result parameters being encoded in the body using the \"application/x-www-form-urlencoded\" format.</p>\n</blockquote>\n<pre><code>HTTP/1.1 200 OK\nContent-Type: text/html;charset=UTF-8\nCache-Control: no-cache, no-store\nPragma: no-cache\n&#x3C;html>\n    &#x3C;head>&#x3C;title>Submit This Form&#x3C;/title>&#x3C;/head>\n    &#x3C;body onload=\"javascript:document.forms[0].submit()\">\n        &#x3C;form method=\"post\" action=\"https://client.example.com/cb\">\n            &#x3C;input type=\"hidden\" name=\"response\"\n            value=\"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2\n            FjY291bnRzLmV4YW1wbGUuY29tIiwiYXVkIjoiczZCaGRSa3F0MyIsImV4cCI6MTM\n            xMTI4MTk3MCwiYWNjZXNzX3Rva2VuIjoiMllvdG5GWkZFanIxekNzaWNNV3BBQSIs\n            InN0YXRlIjoiUzhOSjd1cWs1Zlk0RWpOdlBfR19GdHlKdTZwVXN2SDlqc1luaTlkT\n            UFKdyIsInRva2VuX3R5cGUiOiJiZWFyZXIiLCJleHBpcmVzX2luIjoiMzYwMCIsIn\n            Njb3BlIjoiZXhhbXBsZSJ9.bgHLOu2dlDjtCnvTLK7hTN_JNwoZXEBnbXQx5vd9z1\n            7v1HyzfMqz00Vi002T-SWf2JEs3IVSvAe1xWLIY0TeuaiegklJx_gvB59SQIhXX2i\n            fzRmqPoDdmJGaWZ3tnRyFWNnEogJDqGFCo2RHtk8fXkE5IEiBD0g-tN0GS_XnxlE\"/>\n        &#x3C;/form>\n    &#x3C;/body>\n&#x3C;/html>\n</code></pre>\n<p>The user agent auto submit sending an HTTP POST request to the callback</p>\n<pre><code>POST /cb HTTP/1.1\nHost: client.example.org\nContent-Type: application/x-www-form-urlencoded\nresponse=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2\nFjY291bnRzLmV4YW1wbGUuY29tIiwiYXVkIjoiczZCaGRSa3F0MyIsImV4cCI6MTM\nxMTI4MTk3MCwiYWNjZXNzX3Rva2VuIjoiMllvdG5GWkZFanIxekNzaWNNV3BBQSIs\nInN0YXRlIjoiUzhOSjd1cWs1Zlk0RWpOdlBfR19GdHlKdTZwVXN2SDlqc1luaTlkT\nUFKdyIsInRva2VuX3R5cGUiOiJiZWFyZXIiLCJleHBpcmVzX2luIjoiMzYwMCIsIn\nNjb3BlIjoiZXhhbXBsZSJ9.bgHLOu2dlDjtCnvTLK7hTN_JNwoZXEBnbXQx5vd9z1\n7v1HyzfMqz00Vi002T-SWf2JEs3IVSvAe1xWLIY0TeuaiegklJx_gvB59SQIhXX2i\nfzRmqPoDdmJGaWZ3tnRyFWNnEogJDqGFCo2RHtk8fXkE5IEiBD0g-tN0GS_XnxlE\n</code></pre>\n<h3>4.3.4. Response Mode \"jwt\"</h3>\n<blockquote>\n<p>The response mode \"jwt\" is a shortcut and indicates the default redirect encoding (query, fragment) for the requested response type. The default for response type \"code\" is \"query.jwt\" whereas the default for \"token\" and the response types defined in [OIDM], except \"none\", is \"fragment.jwt\".</p>\n</blockquote>"}},"pageContext":{"title":"Financial-grade API: JWT Secured Authorization Response Mode for OAuth 2.0 (JARM)"}},"staticQueryHashes":["1507822185","2095566405","2894216461","425755332"]}